<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç®¡ç†ä¸­å¿ƒ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .category-item, .file-item {
      cursor: pointer;
      transition: all 0.2s;
    }
    .category-item:hover, .file-item:hover {
      background-color: rgba(99, 102, 241, 0.1);
    }
    .category-item.active, .file-item.active {
      background-color: rgba(99, 102, 241, 0.2);
      border-left: 4px solid #6366f1;
    }
    .prompt-card {
      transition: all 0.2s;
    }
    .prompt-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .modal.show {
      display: flex;
    }
    .tab-button {
      cursor: pointer;
      transition: all 0.2s;
    }
    .tab-button.active {
      border-bottom: 3px solid #6366f1;
      color: #6366f1;
      font-weight: 600;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: flex;
    }
    .markdown-preview {
      line-height: 1.6;
    }
    .markdown-preview h1 { font-size: 2em; font-weight: bold; margin: 1em 0 0.5em; }
    .markdown-preview h2 { font-size: 1.5em; font-weight: bold; margin: 0.83em 0; }
    .markdown-preview h3 { font-size: 1.17em; font-weight: bold; margin: 1em 0; }
    .markdown-preview p { margin: 0.5em 0; }
    .markdown-preview pre { background: #f6f8fa; padding: 1em; border-radius: 6px; overflow-x: auto; }
    .markdown-preview code { background: #f6f8fa; padding: 0.2em 0.4em; border-radius: 3px; font-family: 'Courier New', monospace; }
    .markdown-preview ul, .markdown-preview ol { margin: 0.5em 0; padding-left: 2em; }
    .markdown-preview blockquote { border-left: 4px solid #ddd; padding-left: 1em; margin: 0.5em 0; color: #666; }
  </style>
</head>
<body>
  <div class="min-h-screen p-6">
    <div class="max-w-7xl mx-auto">
      <!-- æ ‡é¢˜æ  -->
      <div class="bg-white rounded-t-xl shadow-lg p-6 mb-0">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold text-gray-800 flex items-center gap-3">
              <i data-lucide="library" class="w-8 h-8 text-indigo-600"></i>
              ç®¡ç†ä¸­å¿ƒ
            </h1>
            <p class="text-gray-600 mt-2">ç®¡ç†æç¤ºè¯å’ŒèŠå¤©è®°å½•</p>
          </div>
          <div class="flex gap-2">
            <button id="btn-help" class="px-4 py-2 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition-colors flex items-center gap-2" title="å¸®åŠ©">
              <i data-lucide="help-circle" class="w-4 h-4"></i>
              å¸®åŠ©
            </button>
            <button id="btn-close" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors flex items-center gap-2">
              <i data-lucide="x" class="w-4 h-4"></i>
              å…³é—­
            </button>
          </div>
        </div>

        <!-- Tab å¯¼èˆª -->
        <div class="flex gap-6 mt-6 border-b border-gray-200">
          <button class="tab-button active px-4 py-2 text-gray-700" data-tab="prompts">
            <i data-lucide="file-text" class="w-4 h-4 inline mr-1"></i>
            æç¤ºè¯ç®¡ç†
          </button>
          <button class="tab-button px-4 py-2 text-gray-700" data-tab="chats">
            <i data-lucide="message-square" class="w-4 h-4 inline mr-1"></i>
            èŠå¤©è®°å½•
          </button>
        </div>
      </div>

      <!-- Tab å†…å®¹åŒº -->
      <!-- æç¤ºè¯ç®¡ç†Tab -->
      <div id="tab-prompts" class="tab-content active bg-white rounded-b-xl shadow-lg" style="min-height: 600px;">
        <div class="w-1/3 border-r border-gray-200 p-4">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-lg font-semibold text-gray-800">ç±»åˆ«</h2>
            <button id="btn-add-category" class="p-2 bg-indigo-100 hover:bg-indigo-200 rounded-lg transition-colors" title="æ–°å¢ç±»åˆ«">
              <i data-lucide="plus" class="w-4 h-4 text-indigo-600"></i>
            </button>
          </div>
          <div id="category-list" class="space-y-2"></div>
        </div>

        <div class="flex-1 p-6">
          <div id="no-selection" class="h-full flex items-center justify-center text-gray-400">
            <div class="text-center">
              <i data-lucide="arrow-left" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
              <p class="text-lg">è¯·ä»å·¦ä¾§é€‰æ‹©ä¸€ä¸ªç±»åˆ«</p>
            </div>
          </div>

          <div id="prompt-section" class="hidden">
            <div class="flex items-center justify-between mb-6">
              <h2 id="category-title" class="text-2xl font-bold text-gray-800"></h2>
              <div class="flex gap-2">
                <button id="btn-add-prompt" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors flex items-center gap-2">
                  <i data-lucide="plus" class="w-4 h-4"></i>
                  æ–°å¢æç¤ºè¯
                </button>
                <button id="btn-edit-category" class="px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition-colors flex items-center gap-2">
                  <i data-lucide="edit" class="w-4 h-4"></i>
                  ç¼–è¾‘ç±»åˆ«
                </button>
                <button id="btn-delete-category" class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors flex items-center gap-2">
                  <i data-lucide="trash-2" class="w-4 h-4"></i>
                  åˆ é™¤ç±»åˆ«
                </button>
              </div>
            </div>
            <div id="prompt-list" class="grid grid-cols-1 gap-4"></div>
          </div>
        </div>
      </div>

      <!-- èŠå¤©è®°å½•Tab -->
      <div id="tab-chats" class="tab-content bg-white rounded-b-xl shadow-lg" style="min-height: 600px;">
        <!-- è®¾ç½®åŒºåŸŸ -->
        <div class="w-full border-b border-gray-200 p-4">
          <div class="flex items-center gap-4">
            <div class="flex-1">
              <label class="block text-sm font-medium text-gray-700 mb-1">èŠå¤©è®°å½•åº“è·¯å¾„</label>
              <div class="flex gap-2">
                <input id="chat-root-path" type="text" readonly class="flex-1 px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700" placeholder="æœªè®¾ç½®">
                <button id="btn-select-folder" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors flex items-center gap-2">
                  <i data-lucide="folder-open" class="w-4 h-4"></i>
                  é€‰æ‹©æ–‡ä»¶å¤¹
                </button>
                <button id="btn-refresh-chats" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2">
                  <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                  åˆ·æ–°
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- ä¸¤æ å¸ƒå±€ -->
        <div class="flex" style="height: 540px;">
          <!-- æ 1: ç±»åˆ«ï¼ˆæ–‡ä»¶å¤¹ï¼‰ -->
          <div class="w-1/3 border-r border-gray-200 p-4 overflow-y-auto">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
              <i data-lucide="folders" class="w-5 h-5"></i>
              ç±»åˆ«
            </h3>
            <div id="chat-category-list" class="space-y-2">
              <div class="text-gray-400 text-sm p-4 text-center">
                è¯·å…ˆé€‰æ‹©èŠå¤©è®°å½•åº“è·¯å¾„
              </div>
            </div>
          </div>

          <!-- æ 2: æ–‡ä»¶åˆ—è¡¨ï¼ˆåŒå‡»æ‰“å¼€ï¼‰ -->
          <div class="flex-1 p-4 overflow-y-auto">
            <div class="flex items-center justify-between mb-3">
              <h3 class="text-lg font-semibold text-gray-800 flex items-center gap-2">
                <i data-lucide="file-text" class="w-5 h-5"></i>
                å¯¹è¯åˆ—è¡¨
              </h3>
              <p class="text-sm text-gray-500">åŒå‡»æ–‡ä»¶åœ¨æ–°çª—å£æ‰“å¼€</p>
            </div>
            <div id="chat-file-list" class="space-y-2">
              <div class="text-gray-400 text-sm p-4 text-center">
                è¯·ä»å·¦ä¾§é€‰æ‹©ç±»åˆ«
              </div>
            </div>
          </div>
        </div>
      </div>
        </div>

        <!-- ä¸¤æ å¸ƒå±€ -->
        <div class="flex" style="height: 540px;">
          <!-- æ 1: ç±»åˆ«ï¼ˆæ–‡ä»¶å¤¹ï¼‰ -->
          <div class="flex-1 p-4 overflow-y-auto">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
              <i data-lucide="folders" class="w-5 h-5"></i>
              ç±»åˆ«
            </h3>
            <div id="chat-category-list" class="space-y-2">
              <div class="text-gray-400 text-sm p-4 text-center">
                è¯·å…ˆé€‰æ‹©èŠå¤©è®°å½•åº“è·¯å¾„
              </div>
            </div>
          </div>

          <!-- æ 2: æ–‡ä»¶åˆ—è¡¨ -->
          <div class="flex-1 p-4 overflow-y-auto">
            <h3 class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-2">
              <i data-lucide="file-text" class="w-5 h-5"></i>
              å¯¹è¯
            </h3>
            <div id="chat-file-list" class="space-y-2">
              <div class="text-gray-400 text-sm p-4 text-center">
                è¯·ä»å·¦ä¾§é€‰æ‹©ç±»åˆ«
              </div>
            </div>
          </div>

          <!-- æ 3: Markdown é¢„è§ˆ -->
          <div class="flex-1 p-4 overflow-y-auto">
            <div id="chat-preview-area">
              <div class="h-full flex items-center justify-center text-gray-400">
                <div class="text-center">
                  <i data-lucide="file" class="w-16 h-16 mx-auto mb-4 opacity-50"></i>
                  <p class="text-lg">é€‰æ‹©å¯¹è¯æŸ¥çœ‹å†…å®¹</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals (from original file) -->
  <div id="modal-category" class="modal">
    <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-md">
      <h3 id="modal-category-title" class="text-xl font-bold text-gray-800 mb-4">æ–°å¢ç±»åˆ«</h3>
      <div class="mb-4">
        <label class="block text-gray-700 mb-2">ç±»åˆ«åç§°</label>
        <input id="input-category-name" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-600" placeholder="ä¾‹å¦‚ï¼šå­¦æœ¯ã€æ•…äº‹ã€ä»£ç ">
      </div>
      <div class="flex gap-2 justify-end">
        <button id="btn-cancel-category" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors">å–æ¶ˆ</button>
        <button id="btn-save-category" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <div id="modal-prompt" class="modal">
    <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-2xl">
      <h3 id="modal-prompt-title" class="text-xl font-bold text-gray-800 mb-4">æ–°å¢æç¤ºè¯</h3>
      <div class="mb-4">
        <label class="block text-gray-700 mb-2">å…³é”®è¯</label>
        <input id="input-prompt-keyword" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-600" placeholder="ä¾‹å¦‚ï¼šæ€»ç»“æ–‡çŒ®ã€ä¼˜åŒ–ä»£ç ">
      </div>
      <div class="mb-4">
        <label class="block text-gray-700 mb-2">æç¤ºè¯æ­£æ–‡</label>
        <textarea id="input-prompt-text" rows="6" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-600" placeholder="è¯·è¾“å…¥å®Œæ•´çš„æç¤ºè¯å†…å®¹..."></textarea>
      </div>
      <div class="flex gap-2 justify-end">
        <button id="btn-cancel-prompt" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors">å–æ¶ˆ</button>
        <button id="btn-save-prompt" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <div id="modal-help" class="modal">
    <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
          <i data-lucide="help-circle" class="w-6 h-6 text-blue-600"></i>
          å¦‚ä½•è·å–æ›´å¤šæç¤ºè¯
        </h3>
        <button id="btn-close-help" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
          <i data-lucide="x" class="w-5 h-5 text-gray-600"></i>
        </button>
      </div>

      <div class="prose max-w-none">
        <div class="mb-8 p-4 bg-gradient-to-r from-red-50 to-pink-50 rounded-lg border border-red-200">
          <h4 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
            <i data-lucide="globe" class="w-5 h-5 text-red-600"></i>
            å›½å†…æ¨èå¹³å°
          </h4>
          <div class="space-y-3 text-gray-700">
            <div class="flex items-start gap-2">
              <i data-lucide="star" class="w-5 h-5 text-yellow-500 mt-0.5 flex-shrink-0"></i>
              <div><span class="font-semibold">å°çº¢ä¹¦</span>ï¼šæœç´¢ "ChatGPT æç¤ºè¯"ã€"AI æç¤ºè¯"ã€"Claude ç ´è§£" ç­‰å…³é”®è¯</div>
            </div>
            <div class="flex items-start gap-2">
              <i data-lucide="star" class="w-5 h-5 text-yellow-500 mt-0.5 flex-shrink-0"></i>
              <div><span class="font-semibold">çŸ¥ä¹</span>ï¼šåœ¨é—®ç­”å’Œæ–‡ç« ä¸­æœç´¢ç›¸å…³è¯é¢˜</div>
            </div>
            <div class="flex items-start gap-2">
              <i data-lucide="star" class="w-5 h-5 text-yellow-500 mt-0.5 flex-shrink-0"></i>
              <div><span class="font-semibold">Bç«™</span>ï¼šæœç´¢ "Prompt Engineering"ã€"æç¤ºè¯æ•™ç¨‹"</div>
            </div>
          </div>
        </div>

        <div class="mb-6">
          <h4 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
            <i data-lucide="crown" class="w-5 h-5 text-purple-600"></i>
            Reddit è®ºå›æ¨è
          </h4>
          <div class="space-y-3">
            <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
              <a href="https://www.reddit.com/r/ChatGPTJailbreak/" target="_blank" class="text-blue-600 hover:text-blue-800 font-semibold">r/ChatGPTJailbreak</a>
              <p class="text-sm text-gray-600 mt-1">æœ€æ´»è·ƒçš„ç ´ç”²ç¤¾åŒº</p>
            </div>
            <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
              <a href="https://www.reddit.com/r/PromptEngineering/" target="_blank" class="text-blue-600 hover:text-blue-800 font-semibold">r/PromptEngineering</a>
              <p class="text-sm text-gray-600 mt-1">æç¤ºè¯å·¥ç¨‹æŠ€æœ¯è®¨è®º</p>
            </div>
          </div>
        </div>

        <div class="mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">
          <h4 class="font-bold text-gray-800 mb-2">ğŸ’¡ ä½¿ç”¨æç¤º</h4>
          <ul class="text-sm text-gray-700 space-y-1 ml-6 list-disc">
            <li>ç‚¹å‡»æç¤ºè¯ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿</li>
            <li>ä½¿ç”¨æµè§ˆå™¨æ’ä»¶å¯¼å‡ºèŠå¤©è®°å½•ä¸º Markdown æ–‡ä»¶</li>
            <li>å»ºè®®å®šæœŸæ›´æ–°æç¤ºè¯åº“</li>
          </ul>
        </div>
      </div>

      <div class="mt-6 flex justify-end">
        <button id="btn-close-help-bottom" class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors">æˆ‘çŸ¥é“äº†</button>
      </div>
    </div>
  </div>

  <script type="module" src="settings.js"></script>
  <script type="module" src="chat-history.js"></script>
  <script>
    lucide.createIcons();
  </script>
</body>
</html>
